<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
    <script>
    function checkEmail(str) {
        var strReg = /^(?!\.)(?![\w.]*?\.\.)[\w.]{1,64}@(?!-)([\w-])+((\.(?!-)[\w-]{2,}){1,})$/;
        if (execReg(strReg, str) == null) {
            return false;
        } else {
            if (!wrodLenCheck(str, 30)) {
                return false;
            }
        }
        return true;
    }
    // jQuery.validator.addMethod("detailAddress",
    //     function(value, element) {
    //         return /^[\u4e00-\u9fa5A-Za-z0-9-]+$/.exec(value);
    //     }
    // );

    function addBlank(str) {
        str = str.trim();
        var regex = /([\u0391-\uFFE5]+)/g;
        var repalcement = " $1 ";
        return str.replace(regex, repalcement);
    }

    function splitAddressString(str) {
        str = addBlank(str);
        var strArray = ["", ""];
        var counter = 0;
        for (var i = 0; i < str.length; i++) {
            if (str.charAt(i).match(/[\u0391-\uFFE5]/)) {
                counter = counter + 2; // 第30位为全角字符第1位 ，则截取至上一字符 
                if (counter == 30 && i < str.length - 1) {
                    strArray[0] = (str.substr(0, i - 1)).trim();
                    strArray[1] = addBlank(str.substr(i - 1));
                    return strArray;
                }
                // 第30位为全角字符第2位，且未到行末,则截取至本字符 
                if (counter == 29 && i < str.length - 1) {
                    strArray[0] = (str.substr(0, i)).trim();
                    strArray[1] = addBlank(str.substr(i));
                    return strArray;
                }
            } else {
                counter = counter + 1;
                // 第29位为半角字符，且前一格字符是全角（截取至上一字符） 
                if (counter == 29 && i <= str.length - 1 && str.charAt(i - 1).match(/[\u0391-\uFFE5]/)) {
                    strArray[0] = (str.substr(0, i - 1)).trim();
                    strArray[1] = addBlank(str.substr(i - 1));
                    return strArray;
                }
                // 第28为为半角字符，且前一格字符是半角（截取至本字符） 
                if (counter == 29 && i <= str.length - 1 && !str.charAt(i - 1).match(/[\u0391-\uFFE5]/)) {
                    strArray[0] = (str.substr(0, i)).trim();
                    strArray[1] = addBlank(str.substr(i));
                    return strArray;
                }
            } // 如果长度小于28，直接返回 
            if (i == str.length - 1 && counter <= 28) {
                strArray[0] = (str).trim();
                strArray[1] = "";
                return strArray;
            } // 如果当前已累计字段长度为30或31，则需要截取 
        }
    }

    function mobileAreaVerifyLength(value, element, length) {
        var strArray = splitAddressString(value);
        return wrodLenCheck((strArray[1].trim()), length);
    }

    function wrodLenCheck(str, maxlen) {
        str = addBlank(str);
        var len = 0;
        for (var i = 0; i < str.length; i++) {
            var c = str.charCodeAt(i);
            if ((c >= 0X0001 && c <= 0X007e) || 0Xff60 <= c && c <= 0Xff9f) {
                len++;
            } else {
                len += 2;
            }
        }
        if (len <= maxlen) {
            return true;
        } else {
            return false;
        }
    }
    mobileAreaVerifyLength('一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十', null, 30);
    </script>
</head>

<body>
</body>

</html>